(()=>{"use strict";const e=class{constructor({urlGet:e,btnClass:t,parentClass:o,blockName:n,wrapper:a,outputKeys:s}){this.urlGet=e,this.btnClass=t,this.parentClass=o,this.blockName=n,this.wrapper=a,this.outputKeys=s}checkContentParent(e,t,o){const n=document.querySelector(`.${e}`).querySelectorAll(`.${t}__${o}`);n&&n.forEach((e=>{e.remove()}))}createDomElement(e,t,o){const n=document.querySelector(`.${e}`),a=document.createElement(t);return o.forEach((e=>{a.classList.add(e)})),n.append(a),a}cardGenerator(e,t,o,n,a){return this.createDomElement(t,"div",[`${o}__${n}`,`${n}`]),e.forEach((e=>{const t=this.createDomElement(`${o}__${n}`,"ul",["card"]);a.forEach((o=>{const n=document.createElement("li");n.textContent=e[o],t.append(n)}))})),e}createBlock(){document.querySelector(`.${this.btnClass}`).addEventListener("click",(e=>{e.preventDefault(),this.checkContentParent(this.parentClass,this.blockName,this.wrapper),fetch(this.urlGet).then((e=>e.json())).then((e=>this.cardGenerator(e,this.parentClass,this.blockName,this.wrapper,this.outputKeys))).then((e=>console.log(e))).catch((e=>console.log(e))).finally((()=>console.log("fetch get end")))}))}},t=function(e){const t=document.querySelector(e),o=t.querySelectorAll("input"),n=[];o.forEach((e=>{n.push(e.placeholder)})),t.addEventListener("click",(a=>{if(a.preventDefault(),"BUTTON"===a.target.tagName&&function(e){let t=!0;return e.forEach((e=>{""===e.value&&(e.classList.add("js-warning"),e.placeholder="form is not fill!!!",t=!1)})),t}(o)){const a=new FormData(t),s={};a.forEach(((e,t)=>{s[t]=e})),fetch("/api/post/",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(s)}).then((e=>e.json())).then((e=>console.log(e))).then((()=>{o.forEach(((e,t)=>{e.classList.remove("js-warning"),e.placeholder=n[t]}))})).then((()=>function(e){const t=document.querySelector(e),o=document.querySelectorAll(`${e} *`),n=document.createElement("p");n.textContent="Данные переданы на сервер",t.append(n),o.forEach((e=>{e.classList.add("js-hide")})),setTimeout((()=>{n.remove(),o.forEach((e=>{e.classList.remove("js-hide"),t.reset()}))}),1e3)}(e))).catch((e=>console.log(e))).finally((()=>console.log("fetch post end")))}}))};document.addEventListener("DOMContentLoaded",(()=>{new e({urlGet:"/api/data/",btnClass:"data__link",parentClass:"data__container",blockName:"data",wrapper:"wrapper",outputKeys:["name","phone"]}).createBlock(),new e({urlGet:"/api/posts/",btnClass:"posts__link",parentClass:"posts__container",blockName:"posts",wrapper:"wrapper",outputKeys:["id","name","message"]}).createBlock(),t(".form-post")}))})();
//# sourceMappingURL=bundle.js.map